generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id        String    @id @default(cuid())
  name      String
  users     User[]
  products  Product[]
  purchases Purchase[]
  stocks    Stock[]
  sales     Sale[]
  createdAt DateTime  @default(now())
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  companyId String
  company   Company  @relation(fields: [companyId], references: [id])
  createdAt DateTime @default(now())
}

model Product {
  id          String     @id @default(cuid())
  description String
  companyId   String
  company     Company    @relation(fields: [companyId], references: [id])

  purchases   Purchase[]
  stocks      Stock[]     // ← ADICIONADO
  sales       Sale[]      // ← ADICIONADO

  createdAt   DateTime   @default(now())
}

model Purchase {
  id              String   @id @default(cuid())
  productId       String
  product         Product  @relation(fields: [productId], references: [id])

  purchaseDate    DateTime
  deliveryDate    DateTime?

  orderNumber     String?
  store           String?
  account         String?

  purchaseValue   Float
  freightCost     Float?
  discountBefore  Float?

  pointsReceived  Int?
  pointsExpected  Int?
  mileValue       Float?
  cashbackValue   Float?

  clubAndStore    String?
  pointsX1        Float?

  finalCost       Float?

  delivered       Boolean  @default(false)

  companyId       String
  company         Company  @relation(fields: [companyId], references: [id])

  createdAt       DateTime @default(now())
}

model Stock {
  id        String   @id @default(cuid())
  productId String
  product   Product  @relation(fields: [productId], references: [id])
  quantity  Int
  finalCost Float
  entryDate DateTime
  companyId String
  company   Company  @relation(fields: [companyId], references: [id])
  createdAt DateTime @default(now())
}

model Sale {
  id           String   @id @default(cuid())
  productId    String
  product      Product  @relation(fields: [productId], references: [id])
  customer     String
  serialNumber String?
  quantity     Int
  unitValue    Float
  totalValue   Float
  profit       Float
  saleDate     DateTime @default(now())
  companyId    String
  company      Company  @relation(fields: [companyId], references: [id])
}
